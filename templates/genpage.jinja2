<html>
<head>
    <title>{{ title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description"
          content="{{ description }}">

    <meta name="keywords"
          content="ai simulator, javascript, css, html, editor, websim, simulator">
    <meta property="og:title" content="{{ title }}">
    <meta property="og:url" content="{{ url }}">
    <meta property="og:image"
          content="{{ static_url }}/images/websim-logo256.webp">
    <meta property="og:image:width" content="256"/>
    <meta property="og:image:height" content="256"/>


    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp,container-queries"></script>

    <style id="webfiddle-css">{{ fiddle.style }}</style>

</head>
<body>
    {{ body | safe }}
</body>

{{ request_blocker | safe }}
<script id="webfiddle-js">
    // Ensure DOM is ready before executing user scripts
    document.addEventListener('DOMContentLoaded', function() {
        try {
            // Decode HTML entities in the script before execution
            const scriptContent = `{{ fiddle.script | safe }}`.replace(/&amp;/g, '&')
                                                           .replace(/&lt;/g, '<')
                                                           .replace(/&gt;/g, '>')
                                                           .replace(/&#39;/g, "'")
                                                           .replace(/&quot;/g, '"');
            
            // Execute the script in the context of the page
            const scriptFunc = new Function(scriptContent);
            scriptFunc();
        } catch(e) {
            console.error('Error executing WebSim script:', e);
        }
    });
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8598649123553748"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8598649123553748"
                        data-ad-slot="4509432206" data-ad-format="auto" data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
</html>
